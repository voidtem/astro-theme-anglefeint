---
doc_id: claude_internal
doc_role: internal-guide
doc_purpose: Internal maintainer guide for architecture and coding conventions.
doc_scope: [internal-architecture, conventions, maintenance]
update_triggers: [architecture-change, naming-change, workflow-change]
source_of_truth: false
depends_on: [docs/ARCHITECTURE.md, docs/VISUAL_SYSTEMS.md, README.md]
---

# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Recent Updates

- Header social links now use `SOCIAL_LINKS` from `src/config/social.ts` (same source as Footer).
- About route generation and nav visibility are gated by `ENABLE_ABOUT_PAGE`.
- New `src/config/about.ts` owns About page profile text, sidebar labels, modal content, and effect strings.
- `public/scripts/about-effects.js` consumes runtime config injected by `src/pages/[lang]/about.astro`.

## Commands

```bash
npm run dev        # Start dev server at localhost:4321
npm run build      # Production build to ./dist/
npm run preview    # Preview production build locally
```

No test or lint commands are configured.

## Architecture

This is a static site built with **Astro 5** using content collections, MDX, and vanilla CSS. No Tailwind — styling is split across global CSS, external page CSS files, and scoped `<style>` blocks.

### Content Pipeline

Blog posts live in `src/content/blog/` as `.md`/`.mdx` files. Schema is defined in `src/content.config.ts` with standard fields (title, description, pubDate, heroImage) plus AI-themed metadata fields (aiModel, aiConfidence, etc.). The `[...slug].astro` page auto-derives reading time, token count, and AI latency from word count.

### Page Themes

- **Home (`/`)** — Matrix falling characters (canvas), body class `page-home`; `/en/` redirects to `/` with noindex
- **Blog list (`/:lang/blog/`)** — Blade Runner cyberpunk (rain, dust), body class `cyber-page`
- **Article (`/:lang/blog/[slug]`)** — AI interface reading layout (58-node network), read progress, Red Queen monitor, `ai-scanlines` on header/footer only (fade on hover), body class `ai-page`. Hero canvas + Red Queen TV: CRT horizontal retrace/dropout (occasional black line flash, starts 6s after load, ~2.5% frames).
- **About (`/:lang/about`)** — Anonymous-style terminal (black/green), body class `hacker-page`. Right sidebar with folder buttons opening modals: DL Data, AI, Decryptor, Help (virtual keyboard), All Scripts (folder grid of blog posts). Generated only when `ENABLE_ABOUT_PAGE` is `true`.

### Key Files

- `src/config/site.ts` — Site identity (SITE_TITLE, SITE_URL, etc.); env-overridable via PUBLIC_* vars
- `src/config/social.ts` — Header/footer social links (SOCIAL_LINKS array)
- `src/config/theme.ts` — BLOG_PAGE_SIZE, HOME_LATEST_COUNT, ENABLE_ABOUT_PAGE (disables About nav/routes when false)
- `src/config/about.ts` — About page profile copy, modal labels/content, terminal effect text
- `src/consts.ts` — Re-exports from config (backwards compat)
- `src/pages/[lang]/about.astro` — About page: terminal canvas, sidebar, modals, `getCollection('blog')` for All Scripts
- `src/layouts/BlogPost.astro` — Post detail layout: AI surface, progress bar, related posts, Red Queen monitor; CRT dropout in `public/scripts/blogpost-effects.js` (hero + Red Queen TV)
- `src/components/shared/ThemeFrame.astro` — Shared document shell (head + header + footer + main container)
- `src/layouts/shells/*.astro` — Theme shells (`BaseShell`, `AiShell`, `CyberShell`, `HackerShell`, `MatrixShell`)
- `src/pages/[lang]/blog/[...page].astro` — Paginated blog list (THEME.BLOG_PAGE_SIZE)
- `src/pages/index.astro` — Root home; `src/pages/[lang]/index.astro` — Localized home (/en/ redirects to /)
- `src/pages/robots.txt.ts` — Dynamic robots.txt with sitemap URL
- `src/components/BaseHead.astro` — Meta, hreflang (x-default), OG, JSON-LD

### SEO

- robots.txt is generated by `robots.txt.ts`; sitemap excludes `/en/`; hreflang x-default points to default-locale version; `alternatePathForLocale` returns `/` for English home.

### Layout

- **Sticky footer:** `body { display: flex; flex-direction: column; min-height: 100vh }`, `main { flex: 1 1 auto }` — footer stays at viewport bottom on short pages (e.g. blog with no articles, 2K/4K).

### Patterns

- Animations respect `prefers-reduced-motion` media query.
- Images are optimized via `sharp` and Astro's `Image` component (stored in `src/assets/`).
- Global styles in `src/styles/global.css`; page-specific styles live in `public/styles/*.css` plus scoped styles in `.astro` files.
- Site is purely static (no API endpoints, no SSR).
